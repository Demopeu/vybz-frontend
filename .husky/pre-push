#!/bin/sh

echo "
██████╗ ███████╗███╗   ███╗ ██████╗ ██████╗ ███████╗██╗   ██╗
██╔══██╗██╔════╝████╗ ████║██╔═══██╗██╔══██╗██╔════╝██║   ██║
██║  ██║█████╗  ██╔████╔██║██║   ██║██████╔╝█████╗  ██║   ██║
██║  ██║██╔══╝  ██║╚██╔╝██║██║   ██║██╔═══╝ ██╔══╝  ██║   ██║
██████╔╝███████╗██║ ╚═╝ ██║╚██████╔╝██║     ███████╗╚██████╔╝
╚═════╝ ╚══════╝╚═╝     ╚═╝ ╚═════╝ ╚═╝     ╚══════╝ ╚═════╝ 

🔍 변경된 패키지에 대해 build 실행 중...
"

ANALYZE=true pnpm run check-before-push
if [ $? -ne 0 ]; then
  echo ""
  echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
  echo "❌ 변경된 패키지 검사 실패! Push가 중단되었습니다."
  echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
  echo ""
  exit 1
fi

echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "✅ 검사 성공! Push를 계속 진행합니다."
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""